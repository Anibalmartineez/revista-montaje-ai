<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Montaje Offset Inteligente</title>
</head>
<body>
  <h1>Montaje Offset Inteligente</h1>
  <form method="POST" enctype="multipart/form-data">
    <label>Subir de 1 a 5 archivos PDF:</label>
    <input type="file" name="archivos[]" accept=".pdf" multiple required>
    <div id="repeticiones-container"></div>
    <script>
      document
        .querySelector('input[name="archivos[]"]')
        .addEventListener('change', function (e) {
          const container = document.getElementById('repeticiones-container');
          container.innerHTML = '';
          [...this.files].forEach((file, index) => {
            const div = document.createElement('div');
            div.innerHTML = `
        <label>${file.name} - Cantidad de repeticiones:</label>
        <input type="number" name="repeticiones_${index}" min="1" value="1" required>
        <input type="hidden" name="nombre_archivo_${index}" value="${file.name}">
        <br><br>
      `;
            container.appendChild(div);
          });
        });
    </script>
    <br><br>
    <label>Seleccionar tamaño de pliego:</label>
    <select name="pliego">
      <option value="640x880">640x880 mm</option>
      <option value="700x1000">700x1000 mm</option>
      <option value="personalizado">Personalizado</option>
    </select>
    <div id="pliego-personalizado" style="display:none;">
      <label>Ancho del pliego (mm):</label>
      <input type="number" name="ancho_pliego_custom" step="0.01">
      <label>Alto del pliego (mm):</label>
      <input type="number" name="alto_pliego_custom" step="0.01">
    </div>
    <br><br>
    <label>Separación doble corte (mm):</label>
    <input type="number" name="separacion" value="4" step="0.01">
    <br>
    <label>Espaciado horizontal (mm):</label>
    <input type="number" name="espaciado_horizontal" value="0" step="0.01">
    <br>
    <label>Espaciado vertical (mm):</label>
    <input type="number" name="espaciado_vertical" value="0" step="0.01">
    <br>
    <label>Margen izquierdo (mm):</label>
    <input type="number" name="margen_izq" value="10" step="0.01">
    <br>
    <label>Margen derecho (mm):</label>
    <input type="number" name="margen_der" value="10" step="0.01">
    <br>
    <label>Margen superior (mm):</label>
    <input type="number" name="margen_sup" value="10" step="0.01">
    <br>
    <label>Margen inferior (mm):</label>
    <input type="number" name="margen_inf" value="10" step="0.01">
    <br>
    <label><input type="checkbox" name="preferir_horizontal"> Preferir orientación horizontal</label><br>
    <label><input type="checkbox" name="ordenar_tamano"> Ordenar por tamaño</label><br>
    <label><input type="checkbox" name="alinear_filas"> Alinear por filas</label><br>
    <label><input type="checkbox" name="centrar_montaje"> Centrar montaje en pliego</label><br>
    <label><input type="checkbox" name="forzar_grilla"> Forzar grilla</label><br>
    <label><input type="checkbox" name="debug_grilla"> Mostrar guías (debug)</label>
    <br>
    <label>Estrategia de montaje:</label>
    <select name="estrategia" id="estrategia">
      <option value="flujo">Flujo (auto)</option>
      <option value="grid">Grid (filas/columnas o celda fija)</option>
      <option value="maxrects">MaxRects (anidado eficiente)</option>
    </select>
    <div id="grid-options" style="display:none;">
      <label>Filas:</label>
      <input type="number" name="filas" min="0" value="0">
      <label>Columnas:</label>
      <input type="number" name="columnas" min="0" value="0">
      <br>
      <label>Ancho celda (mm):</label>
      <input type="number" name="celda_ancho" step="0.01">
      <label>Alto celda (mm):</label>
      <input type="number" name="celda_alto" step="0.01">
    </div>
    <br>
    <button type="submit">Generar Montaje</button>
  </form>
  <script>
    document.querySelector('select[name="pliego"]').addEventListener('change', function() {
      document.getElementById('pliego-personalizado').style.display =
        this.value === 'personalizado' ? 'block' : 'none';
    });
    document.getElementById('estrategia').addEventListener('change', function() {
      document.getElementById('grid-options').style.display =
        this.value === 'grid' ? 'block' : 'none';
    });
  </script>
</body>
</html>
